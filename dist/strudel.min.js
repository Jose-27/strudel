/*!
 * Strudel.js v0.3.3
 * (c) 2016-2017 Mateusz ≈Åuczak
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Strudel=e.Strudel||{})}(this,function(e){"use strict";function t(e){return function(t,n){if(!e)throw new Error("Event descriptor must be provided for Evt decorator");t._events||(t._events=[]),t._events[e]=t[n]}}function n(e){return function(t,n){if(!e)throw new Error("Selector must be provided for El decorator");t._els||(t._els=[]),t._els[e]=n}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},f=function(e,t){return t?s(e,t):s(e)},s=function(e,t){return(t||document).querySelectorAll(e)},l=function(){function e(t,n){if(i(this,e),t instanceof e)return t;"string"==typeof t&&(t=f(t,n)),t&&t.nodeName&&(t=[t]),this._nodes=this.slice(t)}return o(e,[{key:"array",value:function(t){t=t;var n=this;return this._nodes.reduce(function(r,i,o){var c;return t?(c=t.call(n,i,o),c||(c=!1),"string"==typeof c&&(c=u(c)),c instanceof e&&(c=c._nodes)):c=i.innerHTML,r.concat(!1!==c?c:[])},[])}},{key:"str",value:function(e,t){return function(n){return"function"==typeof n?n.call(this,e,t):n.toString()}}},{key:"filter",value:function(t){var n=function(e){return e.matches=e.matches||e.msMatchesSelector||e.webkitMatchesSelector,e.matches(t||"*")};return"function"==typeof t&&(n=t),t instanceof e&&(n=function(e){return-1!==t._nodes.indexOf(e)}),new e(this._nodes.filter(n))}},{key:"first",value:function(){return this._nodes[0]||!1}},{key:"slice",value:function(e){return e&&0!==e.length&&"string"!=typeof e&&"[object Function]"!==e.toString()?e.length?[].slice.call(e._nodes||e):[e]:[]}},{key:"unique",value:function(){return new e(this._nodes.reduce(function(e,t){return null!==t&&void 0!==t&&!1!==t&&-1===e.indexOf(t)?e.concat(t):e},[]))}},{key:"args",value:function(e,t,n){return"function"==typeof e&&(e=e(t,n)),"string"!=typeof e&&(e=this.slice(e).map(this.str(t,n))),e.toString().split(/[\s,]+/).filter(function(e){return e.length})}},{key:"each",value:function(e){return this._nodes.forEach(e.bind(this)),this}},{key:"eacharg",value:function(e,t){return this.each(function(n,r){this.args(e,n,r).forEach(function(e){t.call(this,n,e)},this)})}},{key:"isInPage",value:function(e){return e!==document.body&&document.body.contains(e)}},{key:"map",value:function(t){return t?new e(this.array(t)).unique():this}},{key:"adjacent",value:function(t,n,r){return"number"==typeof n&&(n=0===n?[]:new Array(n).join().split(",").map(Number.call,Number)),this.each(function(i,o){var c=document.createDocumentFragment();new e(n||{}).map(function(e,n){var r="function"==typeof t?t.call(this,e,n,i,o):t;return"string"==typeof r?this.generate(r):u(r)}).each(function(e){this.isInPage(e)?c.appendChild(u(e).clone().first()):c.appendChild(e)}),r.call(this,i,c)})}},{key:"html",value:function(e){return void 0===e?this.first().innerHTML||"":this.each(function(t){t.innerHTML=e})}},{key:"text",value:function(e){return void 0===e?this.first().textContent||"":this.each(function(t){t.textContent=e})}},{key:"remove",value:function(){return this.each(function(e){e.parentNode.removeChild(e)})}},{key:"append",value:function(e,t){return this.adjacent(e,t,function(e,t){e.appendChild(t)})}},{key:"find",value:function(t){return this.map(function(n){return new e(t||"*",n)})}},{key:"addClass",value:function(){return this.eacharg(arguments,function(e,t){e.classList.add(t)})}},{key:"removeClass",value:function(){return this.eacharg(arguments,function(e,t){e.classList.remove(t)})}},{key:"on",value:function(t,n,r){if("string"==typeof n){var i=n;n=function(t){var n=arguments;new e(t.currentTarget).find(i).each(function(e){if(e===t.target||e.contains(t.target)){try{Object.defineProperty(t,"currentTarget",{get:function(){return e}})}catch(e){}r.apply(e,n)}})}}var o=function(e){return n.apply(this,[e].concat(e.detail||[]))};return this.eacharg(t,function(e,t){e.addEventListener(t,o),e._e=e._e||{},e._e[t]=e._e[t]||[],e._e[t].push(o)})}},{key:"off",value:function(e,t){this[0].removeEventListener(e,t,!1)}},{key:"trigger",value:function(e){var t=this.slice(arguments).slice(1);return this.eacharg(e,function(e,n){var r,i={bubbles:!0,cancelable:!0,detail:t};try{r=new window.CustomEvent(n,i)}catch(e){r=document.createEvent("CustomEvent"),r.initCustomEvent(n,!0,!0,t)}e.dispatchEvent(r)})}},{key:"attr",value:function(e,t,n){if(n=n?"data-":"",void 0!==t){var i=e;e={},e[i]=t}return"object"===(void 0===e?"undefined":r(e))?this.each(function(t){for(var r in e)t.setAttribute(n+r,e[r])}):this.length?this.first().getAttribute(n+e):""}},{key:"data",value:function(e,t){return e?this.attr(e,t,!0):this.first().dataset}}]),e}(),h=function(e,t){return new l(e,t)},y=function(){function e(t){i(this,e),this.registry=t}return o(e,[{key:"linkAll",value:function(){this.link(document)}},{key:"link",value:function(e){var t=this,n=!0,r=!1,i=void 0;try{for(var o,u=this.registry.getSelectors()[Symbol.iterator]();!(n=(o=u.next()).done);n=!0)!function(){var n=o.value;[].forEach.call(e.querySelectorAll(n),function(e){if(!e._instance){var r=h(e);e._instance=t.createComponent(r,t.registry.getComponent(n))}})}()}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}}},{key:"createComponent",value:function(e,t){return new t({element:e,data:e.data()})}}]),e}(),v=new Map,d=null,p=function(){function e(){return i(this,e),d||(d=this),d}return o(e,[{key:"getSelectors",value:function(){return v.keys()}},{key:"clear",value:function(){v.clear()}},{key:"getComponent",value:function(e){return v.get(e)}},{key:"registerComponent",value:function(e,t){v.set(e,t)}}]),e}(),m=new p,g=new y(m),b=function(e){return"function"==typeof e||!1},k=function(){function e(){i(this,e),this._listeners=new Map}return o(e,[{key:"addListener",value:function(e,t){this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).push(t)}},{key:"removeListener",value:function(e,t){var n=this._listeners.get(e);if(n&&n.length){var r=n.reduce(function(e,n,r){return b(n)&&n===t?e=r:e},-1);if(r>-1)return n.splice(r,1),this._listeners.set(e,n),!0}return!1}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=this._listeners.get(e);return!(!i||!i.length)&&(i.forEach(function(e){e.apply(void 0,n)}),!0)}}]),e}(),_=function(e,t,n,r){e.on(t,n,r)},w=function(e,t){return!!t&&Object.keys(t).forEach(function(n){var r=t[n],i=n.match(/^(\S+)\s*(.*)$/);e.$element&&_(e.$element,i[1],i[2],r.bind(e))})},E=function(e,t){return!!t&&Object.keys(t).forEach(function(n){var r=t[n];e.$element&&(e[r]=e.$element.find(n))})},C=new k,O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.element,r=t.data;i(this,e),this.$element=n,this.$data=r,w(this,this._events),E(this,this._els),this.beforeInit(),this.init()}return o(e,[{key:"$on",value:function(e,t){C.addListener(e,t)}},{key:"$off",value:function(e,t){C.removeListener(e,t)}},{key:"$emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];C.emit.apply(C,[e].concat(n))}},{key:"beforeInit",value:function(){}},{key:"init",value:function(){}},{key:"finalize",value:function(){}},{key:"destroy",value:function(){this.$element._instance=null,this.finalize()}}]),e}(),S=function(e,t){var n=e.prototype,r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(e){"constructor"!==e&&Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})},j=new p,L=function(e,t){if(!t)throw new Error("Selector must be provided for Component decorator");var n=function(e){function t(){var e;i(this,t);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)))}return c(t,e),t}(O);return S(n,e),Object.defineProperty(n.prototype,"_selector",{value:t}),j.registerComponent(t,n),n},P=function(e){return function(t){return L(t,e)}};!function(){document.addEventListener("DOMContentLoaded",function(){return g.linkAll()}),document.addEventListener("contentloaded",function(){return g.linkAll()})}(),e.Component=P,e.EventEmitter=k,e.Evt=t,e.El=n,e.element=h,Object.defineProperty(e,"__esModule",{value:!0})});