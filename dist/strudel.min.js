/*!
 * Strudel.js v0.1.3
 * (c) 2016-2017 Mateusz ≈Åuczak
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Strudel=t.Strudel||{})}(this,function(t){"use strict";function e(t){return function(e,n){if(!t)throw new Error("Event descriptor must be provided for Evt decorator");e._events||(e._events=[]),e._events[t]=e[n]}}function n(t){return function(e,n){if(!event)throw new Error("Selector must be provided for Evt decorator");e._dom||(e._dom=[]),e._dom[t]=e[n]}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s=function(t,e){return e?f(t,e):f(t)},f=function(t,e){return(e||document).querySelectorAll(t)},l=function(){function t(e,n){if(o(this,t),e instanceof t)return e;"string"==typeof e&&(e=s(e,n)),e&&e.nodeName&&(e=[e]),this._nodes=this.slice(e)}return i(t,[{key:"array",value:function(e){e=e;var n=this;return this._nodes.reduce(function(r,o,i){var c;return e?(c=e.call(n,o,i),c||(c=!1),"string"==typeof c&&(c=u(c)),c instanceof t&&(c=c._nodes)):c=o.innerHTML,r.concat(!1!==c?c:[])},[])}},{key:"str",value:function(t,e){return function(n){return"function"==typeof n?n.call(this,t,e):n.toString()}}},{key:"first",value:function(){return this._nodes[0]||!1}},{key:"slice",value:function(t){return t&&0!==t.length&&"string"!=typeof t&&"[object Function]"!==t.toString()?t.length?[].slice.call(t._nodes||t):[t]:[]}},{key:"unique",value:function(){return new t(this._nodes.reduce(function(t,e){return null!==e&&void 0!==e&&!1!==e&&-1===t.indexOf(e)?t.concat(e):t},[]))}},{key:"args",value:function(t,e,n){return"function"==typeof t&&(t=t(e,n)),"string"!=typeof t&&(t=this.slice(t).map(this.str(e,n))),t.toString().split(/[\s,]+/).filter(function(t){return t.length})}},{key:"each",value:function(t){return this._nodes.forEach(t.bind(this)),this}},{key:"eacharg",value:function(t,e){return this.each(function(n,r){this.args(t,n,r).forEach(function(t){e.call(this,n,t)},this)})}},{key:"isInPage",value:function(t){return t!==document.body&&document.body.contains(t)}},{key:"map",value:function(e){return e?new t(this.array(e)).unique():this}},{key:"adjacent",value:function(e,n,r){return"number"==typeof n&&(n=0===n?[]:new Array(n).join().split(",").map(Number.call,Number)),this.each(function(o,i){var c=document.createDocumentFragment();new t(n||{}).map(function(t,n){var r="function"==typeof e?e.call(this,t,n,o,i):e;return"string"==typeof r?this.generate(r):u(r)}).each(function(t){this.isInPage(t)?c.appendChild(u(t).clone().first()):c.appendChild(t)}),r.call(this,o,c)})}},{key:"html",value:function(t){return void 0===t?this.first().innerHTML||"":this.each(function(e){e.innerHTML=t})}},{key:"text",value:function(t){return void 0===t?this.first().textContent||"":this.each(function(e){e.textContent=t})}},{key:"remove",value:function(){return this.each(function(t){t.parentNode.removeChild(t)})}},{key:"append",value:function(t,e){return this.adjacent(t,e,function(t,e){t.appendChild(e)})}},{key:"find",value:function(e){return this.map(function(n){return new t(e||"*",n)})}},{key:"addClass",value:function(){return this.eacharg(arguments,function(t,e){t.classList.add(e)})}},{key:"removeClass",value:function(){return this.eacharg(arguments,function(t,e){t.classList.remove(e)})}},{key:"on",value:function(t,e,n){this[0].addEventListener(t,function(t){t.target&&t.target.matches(e)&&n(t)},!1)}},{key:"off",value:function(t,e){this[0].removeEventListener(t,e,!1)}},{key:"trigger",value:function(t){var e=this.slice(arguments).slice(1);return this.eacharg(t,function(t,n){var r,o={bubbles:!0,cancelable:!0,detail:e};try{r=new window.CustomEvent(n,o)}catch(t){r=document.createEvent("CustomEvent"),r.initCustomEvent(n,!0,!0,e)}t.dispatchEvent(r)})}},{key:"attr",value:function(t,e,n){if(n=n?"data-":"",void 0!==e){var o=t;t={},t[o]=e}return"object"===(void 0===t?"undefined":r(t))?this.each(function(e){for(var r in t)e.setAttribute(n+r,t[r])}):this.length?this.first().getAttribute(n+t):""}},{key:"data",value:function(t,e){return t?this.attr(t,e,!0):this.first().dataset}}]),t}(),h=function(t,e){return new l(t,e)},y=function(){function t(e){o(this,t),this.registry=e}return i(t,[{key:"linkAll",value:function(){this.link(document)}},{key:"link",value:function(t){var e=this,n=!0,r=!1,o=void 0;try{for(var i,u=this.registry.getSelectors()[Symbol.iterator]();!(n=(i=u.next()).done);n=!0)!function(){var n=i.value;[].forEach.call(t.querySelectorAll(n),function(t){if(!t._instance){var r=h(t);t._instance=e.createComponent(r,e.registry.getComponent(n))}})}()}catch(t){r=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw o}}}},{key:"createComponent",value:function(t,e){return new e({element:t,data:t.data()})}}]),t}(),v=new Map,d=null,p=function(){function t(){return o(this,t),d||(d=this),d}return i(t,[{key:"getSelectors",value:function(){return v.keys()}},{key:"clear",value:function(){v.clear()}},{key:"getComponent",value:function(t){return v.get(t)}},{key:"registerComponent",value:function(t,e){v.set(t,e)}}]),t}(),m=new p,g=new y(m),b=function(t){return"function"==typeof t||!1},k=function(){function t(){o(this,t),this._listeners=new Map}return i(t,[{key:"addListener",value:function(t,e){this._listeners.has(t)||this._listeners.set(t,[]),this._listeners.get(t).push(e)}},{key:"removeListener",value:function(t,e){var n=this._listeners.get(t);if(n&&n.length){var r=n.reduce(function(t,n,r){return b(n)&&n===e?t=r:t},-1);if(r>-1)return n.splice(r,1),this._listeners.set(t,n),!0}return!1}},{key:"emit",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=this._listeners.get(t);return!(!o||!o.length)&&(o.forEach(function(t){t.apply(void 0,n)}),!0)}}]),t}(),_=function(t,e,n,r){t.on(e,n,r)},w=function(t,e){return!!e&&Object.keys(e).forEach(function(n){var r=e[n],o=n.match(/^(\S+)\s*(.*)$/);t.element&&_(t.element,o[1],o[2],r.bind(t))})},E=new k,C=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.element,r=e.data;o(this,t),this.element=n,this.data=r,w(this,this._events),this.beforeInit(),this.init()}return i(t,[{key:"on",value:function(t,e){E.addListener(t,e)}},{key:"off",value:function(t,e){E.removeListener(t,e)}},{key:"emit",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];E.emit.apply(E,[t].concat(n))}},{key:"beforeInit",value:function(){}},{key:"init",value:function(){}}]),t}(),S=function(t,e){var n=t.prototype,r=e.prototype;Object.getOwnPropertyNames(r).forEach(function(t){"constructor"!==t&&Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})},j=new p,O=function(t,e){if(!e)throw new Error("Selector must be provided for Component decorator");var n=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return a(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)))}return c(e,t),e}(C);return S(n,t),Object.defineProperty(n.prototype,"_selector",{value:e}),j.registerComponent(e,n),n},L=function(t){return function(e){return O(e,t)}};!function(){document.addEventListener("DOMContentLoaded",function(){return g.linkAll()}),document.addEventListener("contentloaded",function(){return g.linkAll()})}(),t.Component=L,t.EventEmitter=k,t.Evt=e,t.Dom=n,t.element=h,Object.defineProperty(t,"__esModule",{value:!0})});